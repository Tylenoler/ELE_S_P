#步进电机 #驱动部件
***
# 步进电机基本知识（速查）
（1）拍数——每一次循环所包含的通电状态数（电机转过一个齿距角所需脉冲数）  
（2）单拍制分配方式——状态数=相数  
（3）双拍制分配方式——状态数=相数的两倍  
**（4）步距角 ——步进机通过一个电脉冲转子转过的角度**(N:一个周期的运行拍数 ; Zr：转子齿数 ; 拍数：N=km ;  m:相数 ; k=1单拍制 ; k=2双拍制)
![[Pasted image 20241231193120.png]]
(5)转速
![[Pasted image 20241231193247.png]]
（6）角度细分的原理
- 电磁力的大小与绕组通电电流的大小有关。
- 当通电相的电流并不马上升到位，而断电相的电流也非立即降为0时，它们所产生的磁场合力，会使转子有一个新的平衡位置，这个新的平衡位置是在原来的步距角范围内。
***
# 步进电机的结构
## 步进电机是什么？

步进电机是一种可以与[[脉冲信号]]同步准确地控制旋转角度和转速的[[电机]]。步进电机也称为“脉冲电机”。简单来说，它就是一种能够根据输入的[[脉冲信号]]，精确地控制旋转角度和转速的电机。由于步进电机无需使用位置传感器仅通过[[开环控制]]即可实现准确的定位而被广泛用​​于需要定位的设备中。 

## 两相双极结构
下图从左到右分别是步进电机的外观示例、内部结构简图和结构概念简图。
![[Pasted image 20241231185715.png]]
在外观示例中，给出的是HB（混合）型和PM（永磁）型步进电机的外观。在中间的结构图给出的也是HB型和PM型的结构。
步进电机是线圈固定、永磁体旋转的结构。右侧的步进电机内部结构概念图是使用两相（两组）线圈的PM电机示例。在步进电机基本结构示例中，线圈配置在外侧，永磁体配置在内侧。线圈除了两相外，还有三相和五相等相数较多的类型。
***
# 步进电机工作原理
## 两相双极型
下面使用下图来介绍步进电机的基本工作原理。这是两相双极型线圈每一相（一组线圈）的励磁示例。该图的前提是状态从①到④变化。线圈分别由线圈1和线圈2组成。另外，电流箭头表示电流流动方向。
步进电机的工作原理可以形象地比喻成一个[[齿轮]]系统。电机内部有[[定子]]和[[转子]]，定子上有多个线圈，转子上有多个齿。当给线圈通电时，就会产生磁场，吸引转子上的齿，从而使转子转动一个固定的角度。通过控制通电的线圈顺序和时间，就可以控制转子的转动方向和角度。
![[Pasted image 20241231184551.png]]
- **①**
- ・使电流从线圈1的左侧流入，从线圈1的右侧流出。
- ・勿使电流流过线圈2。
- ・此时，左线圈1的内侧变为N，右线圈1的内侧变为S。
- ・因此，中间的永磁体被线圈1的磁场吸引，变为左侧S和右侧N的状态并停止。

- **②**
- ・停止线圈1的电流，使电流从线圈2的上侧流入，从线圈2的下侧流出。
- ・上线圈2的内侧变为N，下线圈2的内侧变为S。
- ・永磁体被其磁场吸引，顺时针旋转90°停止。

- **③**
- ・停止线圈2的电流，使电流从线圈1的右侧流入，从线圈1的左侧流出。
- ・左线圈1的内侧变为S，右线圈1的内侧变为N。
- ・永磁体被其磁场吸引，顺时针再旋转90°停止。

- **④**
- ・停止线圈1的电流，使电流从线圈2的下侧流入，从线圈2的上侧流出。
- ・上线圈2的内侧变为S，下线圈2的内侧变为N。
- ・永磁体被其磁场吸引，顺时针再旋转90°停止。

通过电子电路按照上述①至④的顺序切换流过线圈的电流，即可使步进电机旋转。在该示例中，每一次开关动作会使步进电机旋转90°。另外，当使电流不断流过某一线圈时，可以保持停止状态并使步进电机具有保持转矩。顺便提一下，如果将流过线圈的电流顺序反过来，则可以使步进电机反向旋转。

***
# 步进电机的基本特性
下图显示了步进电机的转矩和速度之间的关系。纵轴为转矩，横轴为脉冲频率。脉冲频率是指驱动脉冲的频率，在步进电机中，通常使用脉冲频率pps（pulses per second，每秒脉冲数）代替频率Hz。蓝色曲线表示步进电机的“牵入转矩特性”，黄色曲线表示步进电机的“失步转矩特性”。
![[Pasted image 20241231191125.png]]
## 牵入转矩（Pull-in Torque）
“牵入转矩特性”也称为“启动转矩特性”，表示可以使停止状态的步进电机启动的频率（脉冲频率）与负载转矩之间的关系。牵入转矩曲线内的区域称为“自启动区域”，是可以启动、停止和反转的区域。另外，将负载转矩为零的频率＝可以启动步进电机的极限频率称为“最大自启动频率”。如图所示，频率越高，可启动的负载转矩越低。
## 失步转矩（Pull-out Torque）
“失步转矩特性”也称为“连续特性”或“牵出转矩特性”。表示在自启动后增加负载转矩时可以继续旋转的频率。因此，其值高于牵入转矩特性的值。步进电机可以连续运行的极限称为“最大连续运行频率”。与牵入转矩特性一样，失步转矩特性也是负载转矩会随着脉冲频率的增加而降低。
## 保持转矩（Holding Torque）  
步进电机在通电状态下，在步进电机停止时即使施加外力，电机也试图通过转子与定子之间的吸引力来保持停止位置，这种保持力称为“保持转矩”。在上图中，即工作频率（脉冲频率）为零、也就是停止状态下的转矩。

顺便提一下，步进电机的转矩之所以随着工作频率的增加而减小，是因为受绕线电感影响，电流难以在高频条件下流动。

另外，步进电机的牵入转矩特性和失步转矩特性会因励磁方法和驱动电路而异。因此，对步进电机的特性研究中，需要进行包括驱动方法和电路在内的整体评估。
***
# 步进电机微步驱动原理
步进电机可以通过被称为“微步”的驱动方法来实现更精细的步距角控制。
在上文中有一个两相双极线圈逐相励磁的示例。在该示例中，按步（使电流流经一组线圈中的一个而不流经另一个线圈）介绍了步进电机每旋转90°的原理。而微步驱动则可以使步进电机按照更精细的步距角旋转。

步进电机的微步驱动有优点主要有两个：一个是可以控制微小角度的位置。另一个是可以降低低速范围内的振动和噪声。步进电机在每一步都伴随着阻尼振动，最终停止在所定位置。也就是说，相对于停止位置经过多次向前过头和后退过头后最终完全停止。如果步进电机低速旋转，则这种阻尼振动可能会引起振动和噪声。通过减小步距角可以减少阻尼振动，通过微步驱动可以降低低速范围的振动和噪声。

接下来使用下图来介绍步进电机微步驱动的工作原理。该图是两相双极结构，按照简单的线圈切换，步距角应该为90°，但下图是将其均分为四的1/4微步驱动示例。当使电机按90°的1/4 = 22.5°旋转时，各线圈的电流和磁场如①～⑤的顺序所示。
![[Pasted image 20241231191541.png]]
- **①（具体如下图所示）**
- ・使电流从线圈1的左侧流入，从线圈1的右侧流出。
- ・勿使电流流过线圈2。
- ・此时，左线圈1的内侧变为N，右线圈1的内侧变为S。
- ・中间的永磁体* 被线圈1的磁场吸引，变为左侧S和右侧N的状态并停止。
- ・假设当线圈电流为Io时，产生的磁场大小为M0。  
![[Pasted image 20241231191658.png]]
- **②**
- ・若要使之从①顺时针旋转22.5°（90°的1/4），需要保持磁场强度M0并产生使永磁体在相应位置停止的磁场。
- ・要实现这个目标，只要使线圈1产生M0×cos（22.5°）≒M0×0.924的磁场，使线圈2产生M0×sin（22.5°）≒M0×0.383的磁场即可。
- ・为此，需要将线圈1的电流控制为Io×cos（22.5°）≒Io×0.924，将线圈2的电流控制为Io×sin（22.5°）≒Io×0.383。

- **③**
- ・若要再向前旋转22.5°（即从①顺时针旋转45°），需要产生相应的磁场M0。
- ・要实现这个目标，只要使线圈1产生M0×cos（45°）≒M0×0.707的磁场，使线圈2产生M0×sin（45°）≒M0×0.707的磁场即可。
- ・为此，需要将线圈1的电流控制为Io×cos（45°）≒Io×0. 707，将线圈2的电流控制为Io×sin（45°）≒Io×0.707。

- **④**
- ・若要再向前旋转22.5°（即从①向前旋转67.5°），同样需要产生相应的M0。
- ・要实现这个目标，只要使线圈1产生M0×cos（67.5°）≒M0×0.383的磁场，使线圈2产生M0×sin（67.5°）≒M0×0.924的磁场即可。
- ・为此，需要将线圈1的电流控制为Io×cos（67.5°）≒Io×0.383，将线圈2的电流控制为Io×sin（67.5°）≒Io×0.924。

- **⑤**
- ・若要再向前旋转22.5°（即从①旋转90°），需要使电流Io通过线圈2，并使线圈1中的电流为0。

如上所述，磁场的大小恒定、根据角度控制流过各线圈的电流来形成磁场、并通过任意步距使转子旋转和停止的工作称为“微步驱动工作”。

该图是将90°均分为四的1/4步进的步进电机的驱动示例，不过目前已经可以实现1/32步进驱动。如前所述，步进电机通过微步驱动可进行微小角度位置控制并减少噪声和振动。

***
# 混合式步进电机的结构和工作原理
## 结构
混合式步进电机是兼具VR型和PM型电机优点的步进电机。VR（Variable Reluctance）型电机使用齿轮状的铁芯作为转子。其优点是可以通过机械加工减小步距角，缺点是转矩稍低，难以同时实现小型化和大转矩。而PM（Permanent Magnet）型电机则可以通过强力永磁体实现小型化的同时获得转矩，但是在减小步距角方面存在限制。
混合式电机使用VR型结构来实现精细的步距角，并且可以通过与永磁体相结合来增加转矩，这种电机已被用于众多应用。
转子的基本结构是在两个铁转子之间夹着沿轴向着磁的圆柱形磁铁。转子的圆周上刻有齿。从轴向看，是将两个转子的齿错开1/2节距进行安装。定子具有多个带有励磁线圈的磁极，每个磁极也具有类似于转子的齿。
![[Pasted image 20241231191940.png]]
在该图中，定子绕组有四个，它们布置在转子周围，彼此对置的线圈作为一组连接，在该图中，上侧和下侧的线圈为A相，左侧和右侧的线圈为B相。线圈的连接使两个相对的磁极在通电后互为N极和S极。

图中的转子齿数为15个。假设白色转子是靠近自己这边的转子并已通过永磁体被磁化为N极，则蓝色转子位于背面并被磁化为S极。

## 工作原理
下面使用下图来介绍混合式步进电机的工作原理。在初始状态（参见上面的“初始状态”图），通电后A相（上下）的上磁极变为S极，下磁极变为N极。白色的齿为N极，因此与A相的S极相吸；而蓝色的齿为S极，因此与A相的N极相吸。从该状态开始，使线圈的通电状态按照①～⑤的顺序变化。
![[Pasted image 20241231192018.png]]
下面对①～⑤的工作进行说明。
- ①B相（左右）通电，使右侧为S极，左侧为N极。位于前面的白色齿（N）与右磁极（S）相吸，位于背面的蓝色齿（S）与左磁极（N）相吸。
- ②当通电使A相（上下）的上磁极为N、下磁极为S时，前面的白色齿（N）与下磁极（S）相吸，背面的蓝色齿（S）与上磁极（N）相吸，转子进一步沿逆时针方向转动。
- ③当使B相（左右）与①反向通电时，前面的白色齿（N）与左磁极（S）相吸并转动，背面的蓝色齿（S）与右磁极（N）相吸并转动。
- ④当使A相（上下）与②反向通电时，前面的白色齿（N）与上磁极（S）相吸并转动，背面的蓝色齿（S）与下磁极（N）相吸并转动。当通电使上磁极为S、下磁极为N时，转子以相同的方式转动，并且转子相对于初始状态（参见上面的“初始状态”图）旋转一个齿距。
- ⑤当通电使B相（左右）右磁极为S、左磁极为N（与①相同）时，转子以相同的方式转动，并且相对于①旋转一个齿距。
综上所述，转子按照①～⑤中的四个步骤沿逆时针方向转动一个齿距，通过重复这些步骤的动作来使电机连续旋转。要沿相反的顺时针方向旋转时，请按⑤～①的顺序控制通电。
*** 
# 步进电机的驱动
## 双极连接
![[Pasted image 20241231192117.png]]
双极连接的方法如图所示，采用电流在一个绕组中双向流动的驱动方式（双极驱动）。这种方式电机的结构比较简单，端子数也较少，但由于必须控制一个端子的极性，因此驱动电路较为复杂。不过，这种电机的绕组利用率好，并且可以进行精细的控制，因此可以获得很高的输出转矩。另外，还可以减小在线圈中产生的反电动势，所以可以使用耐压较低的电机驱动器。
## 单极连接
![[Pasted image 20241231192138.png]]
如图所示，单极连接具有一个中心抽头，采用电流在一个绕组中始终沿固定方向流动的驱动方式（单极驱动）。虽然步进电机的结构较为复杂，但是由于仅需要电流ON/OFF的控制，因此步进电机的驱动电路较简单。不过，其绕组的利用率较差，与双极连接相比只能获得约一半的输出转矩。另外，由于电流ON/OFF时会在线圈中产生很高的反电动势，所以需要使用高耐压的电机驱动器。
***
# 两相双极步进电机的驱动
## 两相双极驱动电路的基本框图示例
![[Pasted image 20241231192225.png]]
可使用双通道的H桥驱动电路来驱动两相双极步进电机。该框图是通过PWM工作进行恒流驱动的电路示例，其工作原理基本上与[使用PWM输出方式驱动有刷直流电机](https://techclass.rohm.com.cn/knowledge/motor/basics/basics-03/362 "使用PWM输出方式驱动有刷直流电机")相同。

电机电流衰减时的电流再生模式包括Slow Decay（慢速衰减）和Fast Decay（快速衰减）。在有的模式下，电流的跟随性可能会降低，或者可能会引起振动或噪声。针对这种问题，还有一种具有Mix Decay（混合衰减）功能的驱动器，可以从外部调节Slow Decay和Fast Decay的比例。关于电流再生模式，计划在“其2”中进行说明。

下面是两相双极步进电机驱动的2相励磁（Slow Decay时）、1-2相励磁（两相时全转矩，Slow Decay时）、1-2相励磁（两相时转矩=单相时转矩，Slow Decay时）、1/4步励磁（Slow Decay时）的波形图。要确认的要点是输入信号INxx、输出电压OUTxx、各输出电流以及步数之间的关系。在1/4步这种情况下，由于可以使步距更精细，电流的变化也比较缓和，故可以使电机平稳地旋转。
## 两相励磁
![[Pasted image 20241231192249.png]]
## 1-2相励磁
![[Pasted image 20241231192333.png]]
![[Pasted image 20241231192347.png]]
## 1/4步励磁
![[Pasted image 20241231192359.png]]
## Decay（电流衰减）
在驱动步进电机时，需要进行Decay（电流衰减）控制。
Decay是一种在关断对电机的电源供给时使电流衰减的方法，有Slow Decay（慢速衰减）和Fast Decay（快速衰减）两种基本方法。
以下是上一篇中给出的步进电机驱动波形中的一部分。输出电压OUT是PWM信号，因此输出电流是与PWM信号联动ON/OFF的平均电流。由于驱动的是线圈，所以输出电流的波形是锯齿波，而不是PWM电压输出的方波。下图是输出电流的放大波形。
![[Pasted image 20241231192504.png]]
蓝色波形是Slow Decay时的波形，由于衰减的斜率小，故电流衰减速度慢，PWM关断期间的电流衰减也较慢。因此，在导通时达到设定电流值的时间也缩短了。
红色是Fast Decay时的波形，由于斜率较大，因此电流衰减速度快，衰减量也很大，也因此在导通时需要花一些时间才能达到设定的电流值，周期比Slow Decay要慢。
## Slow Decay和Fast Decay
可以通过切换电机驱动器输出H桥来选择衰减方法。
![[Pasted image 20241231192548.png]]
图中的线圈表示步进电机的线圈A和线圈B的一个线圈。这里省略了不在H桥四个开关的内部电流路径中的开关。
在Slow Decay（a）中，Q1和Q4处于导通状态。在（b）和（c）中，Q4导通，Q2导通和关断。尽管开关的状态不同，但由于再生电流也会经由寄生二极管流向关断的Q2的MOSFET，因此无论在哪种情况下，电流都以相同的方式流过。再生电流则仅是线圈中蓄积的电流流动。
（D）Fast Decay的（d）处于导通状态，与Slow Decay的状态相同。在（e）中，Q2和Q3导通；在（f）中，所有的MOSFET均关断，再生电流流经导通的Q2和Q3，也会经由寄生二极管流过关断的Q2和Q3，因此在这两种情况下电流都以相同的方式流过。电流会流向电源，但由于电源电压试图使电流沿相反方向流动，所以电流的衰减加快。  
可以根据以哪种状态控制关断来区分使用“Slow Decay”和“Fast Decay”。
## 衰减方法的差异与步进电机驱动的关系
与Fast Decay相比，Slow Decay的电流纹波更小，因此噪声更小。另外，由于平均电流增加，所以可以增加产生的转矩。但其缺点是如果脉冲频率变快，波形会失真，电机无法正常旋转。
相反，Fast Decay在噪声和转矩方面虽然逊色，但对于高速脉冲频率，则比Slow Decay更具优势。
## Mix Decay（混合衰减）
衰减方法基本上是Slow Decay和Fast Decay，不过还有一种将它们结合起来并充分利用两者优点的方法，即Mix Decay。
Mix Decay是以Fast Decay开始衰减，然后是Slow Decay。这使得电流衰减比Slow Decay快，而电流纹波比Fast Decay小。这不仅可以维持大转矩，同时还支持高速脉冲率。某些驱动器IC可以调整Slow和Fast的时间比，可优化电流波形。
![[Pasted image 20241231192627.png]]
以下是不同步数Slow/Mix/Fast Decay时的波形。从波形可以看出，Mix Decay已得到优化。
![[Pasted image 20241231192639.png]]
***